@using Flex_SGM.Models;

@model IEnumerable<Flex_SGM.Models.Metricos>

@{
    ViewBag.Title = "Métricos";
}
@using (Html.BeginForm())
 {
    <a></a>
    <div class="col-md-12" style="width: 100%">
        <div class="x_panel cbg">
            <div class="x_content clearfix">
                <center>
                    <h1>Crear un Registro Nuevo</h1>
                </center>
                <div class="col-md-2">
                    <a href="~/AMEF/Create">
                        <input type="button" value="AMEF/Reverse" class="btn btn-primary col-md-12" style="min-width: 200px; margin-bottom: 10px" />
                    </a>
                </div>
                <div class="col-md-2">
                    <a href="~/BuildinBuildout/Create">
                        <input type="button" value="Build In / Build Out" class="btn btn-primary col-md-12" style="min-width: 200px; margin-bottom: 10px" />
                    </a>
                </div>
                <div class="col-md-2">
                    <a href="~/Capacities/Create">
                        <input type="button" value="Capacities Review" class="btn btn-primary col-md-12" style="min-width: 200px; margin-bottom: 10px" />
                    </a>
                </div>
                <div class="col-md-2">
                    <a href="~/CI_MP/Create">
                        <input type="button" value="Continuous Improvement" class="btn btn-primary col-md-12" style="min-width: 200px; margin-bottom: 10px" />
                    </a>
                </div>
                <div class="col-md-2">
                    <a href="~/Customer_Complaints/Create">
                        <input type="button" value="Customer Complaints" class="btn btn-primary col-md-12" style="min-width: 200px; margin-bottom: 10px" />
                    </a>
                </div>
                <div class="col-md-2">
                    <a href="~/Cust_Score_Cards/Create">
                        <input type="button" value="Customer Score Cards" class="btn btn-primary col-md-12" style="min-width: 200px; margin-bottom: 10px" />
                    </a>
                </div>
                <div class="col-md-2">
                    <a href="~/ECNs_PCRs/Create">
                        <input type="button" value="ECNs & PCRs" class="btn btn-primary col-md-12" style="min-width: 200px; margin-bottom: 10px" />
                    </a>
                </div>
                <div class="col-md-2">
                    <a href="~/Lay_Out/Create">
                        <input type="button" value="Lay Out Changes" class="btn btn-primary col-md-12" style="min-width: 200px; margin-bottom: 10px" />
                    </a>
                </div>
                <div class="col-md-2">
                    <a href="~/LPA_COVID/Create">
                        <input type="button" value="LPA / COVID Audits" class="btn btn-primary col-md-12" style="min-width: 200px; margin-bottom: 10px" />
                    </a>
                </div>
                <div class="col-md-2">
                    <a href="~/Packaging/Create">
                        <input type="button" value="Packaging Portals" class="btn btn-primary col-md-12" style="min-width: 200px; margin-bottom: 10px" />
                    </a>
                </div>
                <div class="col-md-2">
                    <a href="~/Parts_Delivery/Create">
                        <input type="button" value="Parts Delivery on Time" class="btn btn-primary col-md-12" style="min-width: 200px; margin-bottom: 10px" />
                    </a>
                </div>
                <div class="col-md-2">
                    <a href="~/PLM/Create">
                        <input type="button" value="PLM / Launch Matrix" class="btn btn-primary col-md-12" style="min-width: 200px; margin-bottom: 10px" />
                    </a>
                </div>
                <div class="col-md-2">
                    <a href="~/Quality_HS/Create">
                        <input type="button" value="Quality and H&S 5 min Talk" class="btn btn-primary col-md-12" style="min-width: 200px; margin-bottom: 10px" />
                    </a>
                </div>
                <div class="col-md-2">
                    <a href="~/Red_Rabbits/Create">
                        <input type="button" value="Red Rabbit Audits" class="btn btn-primary col-md-12" style="min-width: 200px; margin-bottom: 10px" />
                    </a>
                </div>
                <div class="col-md-2">
                    <a href="~/Safety_HS/Create">
                        <input type="button" value="Saftey Issues (H & S)" class="btn btn-primary col-md-12" style="min-width: 200px; margin-bottom: 10px" />
                    </a>
                </div>
                <div class="col-md-2">
                    <a href="~/Scrap/Create">
                        <input type="button" value="Scrap Costs" class="btn btn-primary col-md-12" style="min-width: 200px; margin-bottom: 10px" />
                    </a>
                </div>
                <div class="col-md-2">
                    <a href="~/TOC_HS_Audits/Create">
                        <input type="button" value="TOC/H&S Audits" class="btn btn-primary col-md-12" style="min-width: 200px; margin-bottom: 10px" />
                    </a>
                </div>
                <div class="col-md-2">
                    <a href="~/Yellow_Sheets/Create">
                        <input type="button" value="Yellow Sheet & BOM´s Audited" class="btn btn-primary col-md-12" style="min-width: 200px; margin-bottom: 10px" />
                    </a>
                </div>
            </div>
        </div>
    </div>
 }
<div class="x_panel cbg">
    <div class="x_content clearfix">
        <table class="display table table-bordered table-striped" id="metricoTable" style="width:100%; overflow-x:auto;">
            <thead>
                <tr>
                    <th>
                        @Html.DisplayNameFor(model => model.DiaHora)
                    </th>
                    <th>
                        @Html.DisplayNameFor(model => model.Usuario)
                    </th>
                    <th>
                        @Html.DisplayNameFor(model => model.Usuario_area)
                    </th>
                    <th>
                        @Html.DisplayNameFor(model => model.Usuario_responsable)
                    </th>
                    <th>
                        @Html.DisplayNameFor(model => model.Descripcion)
                    </th>
                    <th>
                        @Html.DisplayNameFor(model => model.Comentarios)
                    </th>
                    <th>
                        @Html.DisplayNameFor(model => model.Proyectos)
                    </th>
                    <th>Opciones</th>
                </tr>
            </thead>
            <tbody>
                @foreach (var item in Model)
                 {
                    <tr>
                        <td>
                            @Html.DisplayFor(modelItem => item.DiaHora)
                        </td>
                        <td>
                            @Html.DisplayFor(modelItem => item.Usuario)
                        </td>
                        <td>
                            @Html.DisplayFor(modelItem => item.Usuario_area)
                        </td>
                        <td>
                            @Html.DisplayFor(modelItem => item.Usuario_responsable)
                        </td>
                        <td style="width: 400px">
                            @Html.DisplayFor(modelItem => item.Descripcion)
                        </td>
                        <td style="width: 200px">
                            @Html.DisplayFor(modelItem => item.Comentarios)
                        </td>
                        <td>
                            @Html.DisplayFor(modelItem => item.Proyectos)
                        </td>
                        <td>
                            @if (ViewBag.super == true)
                            {
                                @Html.ActionLink("Editar", "Edit", new { id = item.ID })
                            } |
                            @Html.ActionLink("Detalles", "Details", new { id = item.ID }) |
                            @if (ViewBag.super == true)
                            {
                                @Html.ActionLink("Eliminar", "Delete", new { id = item.ID })
                            }
                        </td>
                    </tr>
                 }
            </tbody>
        </table>
    </div>
</div>
<div class="x_panel cbg">
    <div class="x_title clearfix">
        <h2>
            Business Excellence de Enero a Diciembre de
            <select name="years" id="years" style="background-color: #f2f6f8">
                <option value="2022">2022</option>
                <option value="2023">2023</option>
                <option value="2024">2024</option>
                <option value="2025">2025</option>
                <option value="2026">2026</option>
                <option value="2027">2027</option>
                <option value="2028">2028</option>
                <option value="2029">2029</option>
                <option value="2030">2030</option>
            </select>
        </h2>
        <ul class="nav navbar-right">
            <li>
                <a class="collapse-link collapse" data-toggle="collapse"><i class="fa fa-chevron-down"></i></a>
            </li>
        </ul>
    </div>
    <div class="x_content" id="collapseOne" data-toggle="false" style="display: none">
        <table class="table table-bordered table-striped" style="width:100%; height:100%" id="metric">
            <thead>
                <tr>
                    <td style="width:15%;"><h3>Descripción</h3></td>
                    @foreach (var item in ViewBag.data)
                    {
                        <td>@item.TiempoLabel</td>
                    }
                </tr>
            </thead>
            <tbody>
                <tr>
                    <th><h3>Work Standarization</h3></th>
                    @foreach (var item in ViewBag.data)
                    {
                        <td>@item.WrkStd%</td>
                    }
                </tr>
                <tr>
                    <th><h3>Accountability</h3></th>
                    @foreach (var item in ViewBag.data)
                    {
                        <td>@item.Accnt%</td>
                    }
                </tr>
                <tr>
                    <th><h3>Continuos Improvement</h3></th>
                    @foreach (var item in ViewBag.data)
                    {
                        <td>@item.ConImp%</td>
                    }
                </tr>
                <tr>
                    <th><h3>Customer Focus</h3></th>
                    @foreach (var item in ViewBag.data)
                    {
                        <td>@item.CstFcs%</td>
                    }
                </tr>
                <tr>
                    <th><h3>Sustainability</h3></th>
                    @foreach (var item in ViewBag.data)
                    {
                        <td>@item.Sustan%</td>
                    }
                </tr>
            </tbody>
        </table>
    </div>
</div>

<div class="x_panel cbg">
    <div class="x_title clearfix">
        <h2>Indicadores de Enero a Diciembre de @ViewBag.dx</h2>
        <ul class="nav navbar-right">
            <li>
                <a class="collapse-link collapse" data-toggle="collapse"><i class="fa fa-chevron-down"></i></a>
            </li>
        </ul>
    </div>
    <div class="x_content" id="collapseOne" data-toggle="false" style="display: none">
        <table class="table table-bordered table-striped" style="width:100%; height:100%" id="metricox">
            <thead>
                <tr>
                    <td style="width:16%;"><h3>Descripción</h3></td>
                    <td style="width:10%;"><h3>Responsable</h3></td>
                    <td style="width:15%;"><h3>Meta</h3></td>
                    @foreach (var item in ViewBag.data)
                    {
                        <td>@item.TiempoLabel</td>
                    }
                </tr>
            </thead>
            <tbody>
                <tr>
                    <th><p>@Html.ActionLink("AMEF/Reverse", "Index", "AMEF")</p></th>
                    <th scope="row">Manuel Jimenez</th>
                    <th scope="row">100% Complete</th>
                    @foreach (var item in ViewBag.data)
                    {
                        <td>@item.Amef%</td>
                    }
                </tr>
                <tr>
                    <th><p>@Html.ActionLink("Build in/Build out", "Index", "BuildinBuildout")</p></th>
                    <th scope="row">Marcelino Prado</th>
                    <th scope="row">Zero obsolete</th>
                    @foreach (var item in ViewBag.data)
                    {
                        <td>@item.BiBo</td>
                    }
                </tr>
                <tr>
                    <th><p>@Html.ActionLink("Capacities Review", "Index", "Capacities")</p></th>
                    <th scope="row">Adriana Velazquez</th>
                    <th scope="row">Monthly Report</th>
                    @foreach (var item in ViewBag.data)
                    {
                        <td>@item.CapPer%</td>
                    }
                </tr>
                <tr>
                    <th><p>@Html.ActionLink("Continous Improvement", "Index", "CI_MP")</p></th>
                    <th scope="row">Gabriela Vasquez</th>
                    <th scope="row">100% Monthly /1 project month</th>
                    @foreach (var item in ViewBag.data)
                    {
                        <td>@item.CoImPer%</td>
                    }
                </tr>
                <tr>
                    <th><p>@Html.ActionLink("Customer Complaints  ( Eng )", "Index", "Customer_Complaints")</p></th>
                    <th scope="row">Donato Salazar</th>
                    <th scope="row">0 Complaints</th>
                    @foreach (var item in ViewBag.data)
                    {
                        <td>@item.CuCo</td>
                    }
                </tr>
                <tr>
                    <th><p>@Html.ActionLink("Customer Score Cards Ford", "Index", "Cust_Score_Cards")</p></th>
                    <th scope="row">Cynthia Alvarez</th>
                    <th scope="row">100% Complete</th>
                    @foreach (var item in ViewBag.data)
                    {
                        <td>@item.Ford%</td>
                    }
                </tr>
                <tr>
                    <th><p>@Html.ActionLink("Customer Score Cards Ford APQP", "Index", "Cust_Score_Cards")</p></th>
                    <th scope="row">Cynthia Alvarez</th>
                    <th scope="row">5</th>
                    @foreach (var item in ViewBag.data)
                    {
                        <td>@item.Ford_APQP</td>
                    }
                </tr>
                <tr>
                    <th><p>@Html.ActionLink("Customer Score Cards GM", "Index", "Cust_Score_Cards")</p></th>
                    <th scope="row">Cynthia Alvarez</th>
                    <th scope="row">100% Complete</th>
                    @foreach (var item in ViewBag.data)
                    {
                        <td>@item.GM%</td>
                    }
                </tr>
                <tr>
                    <th><p>@Html.ActionLink("Customer Score Cards Mopar", "Index", "Cust_Score_Cards")</p></th>
                    <th scope="row">Cynthia Alvarez</th>
                    <th scope="row">100% Complete</th>
                    @foreach (var item in ViewBag.data)
                    {
                        <td>@item.Mopar%</td>
                    }
                </tr>
                <tr>
                    <th><p>@Html.ActionLink("Customer Score Cards Nissan", "Index", "Cust_Score_Cards")</p></th>
                    <th scope="row">Cynthia Alvarez</th>
                    <th scope="row">100% Complete</th>
                    @foreach (var item in ViewBag.data)
                    {
                        <td>@item.Nissan%</td>
                    }
                </tr>
                <tr>
                    <th><p>@Html.ActionLink("Customer Score Cards Stellantis", "Index", "Cust_Score_Cards")</p></th>
                    <th scope="row">Cynthia Alvarez</th>
                    <th scope="row">100% Complete</th>
                    @foreach (var item in ViewBag.data)
                    {
                        <td>@item.Stellantis%</td>
                    }
                </tr>
                <tr>
                    <th><p>@Html.ActionLink("Customer Score Cards Toyota", "Index", "Cust_Score_Cards")</p></th>
                    <th scope="row">Cynthia Alvarez</th>
                    <th scope="row">100% Complete</th>
                    @foreach (var item in ViewBag.data)
                    {
                        <td>@item.Toyota%</td>
                    }
                </tr>
                <tr>
                    <th><p>@Html.ActionLink("Customer Score Cards VW", "Index", "Cust_Score_Cards")</p></th>
                    <th scope="row">Cynthia Alvarez</th>
                    <th scope="row">100% Complete</th>
                    @foreach (var item in ViewBag.data)
                    {
                        <td>@item.VW%</td>
                    }
                </tr>
                <tr>
                    <th><p>@Html.ActionLink("ECN’s / PCR´s", "Index", "ECNs_PCRs")</p></th>
                    <th scope="row">Zaideth Vazquez</th>
                    <th scope="row">0 Abiertos en Tiempo</th>
                    @foreach (var item in ViewBag.data)
                    {
                        <td>@item.Ecn</td>
                    }
                </tr>
                <tr>
                    <th><p>@Html.ActionLink("Lay Out Changes", "Index", "Lay_Out")</p></th>
                    <th scope="row">Hipolito Gutierrez</th>
                    <th scope="row">100% Completed</th>
                    @foreach (var item in ViewBag.data)
                    {
                        <td>@item.LaOu%</td>
                    }
                </tr>
                <tr>
                    <th><p>@Html.ActionLink("LPA / Covid Audits", "Index", "LPA_COVID")</p></th>
                    <th scope="row">Miguel Coronado</th>
                    <th scope="row">0 LPAs Incumplidos</th>
                    @foreach (var item in ViewBag.data)
                    {
                        <td>@item.Lpa</td>
                    }
                </tr>
                <tr>
                    <th><p>@Html.ActionLink("Packaging Portals", "Index", "Packaging")</p></th>
                    <th scope="row">Antonio Rojas</th>
                    <th scope="row">0 Abiertos en Tiempo</th>
                    @foreach (var item in ViewBag.data)
                    {
                        <td>@item.PaPo</td>
                    }
                </tr>
                <tr>
                    <th><p>@Html.ActionLink("Parts Delivery on time ", "Index", "Parts_Delivery")</p></th>
                    <th scope="row">Carlos Olvera</th>
                    <th scope="row">Delivery according to schedule</th>
                    @foreach (var item in ViewBag.data)
                    {
                        <td>@item.PaDe%</td>
                    }
                </tr>
                <tr>
                    <th><p>@Html.ActionLink("PLM / Launch Matrix", "Index", "PLM")</p></th>
                    <th scope="row">Armando Prado</th>
                    <th scope="row">0 Abiertos en Tiempo</th>
                    @foreach (var item in ViewBag.data)
                    {
                        <td>@item.Plm</td>
                    }
                </tr>
                <tr>
                    <th><p>@Html.ActionLink("Quality and H&S 5 min Talk", "Index", "Quality_HS")</p></th>
                    <th scope="row">Carlos Rodriguez</th>
                    <th scope="row">100% Completed</th>
                    @foreach (var item in ViewBag.data)
                    {
                        <td>@item.QuHs%</td>
                    }
                </tr>
                <tr>
                    <th><p>@Html.ActionLink("Red Rabbits Audit", "Index", "Red_Rabbits")</p></th>
                    <th scope="row">Hector Salomon</th>
                    <th scope="row">100% on time & implemented</th>
                    @foreach (var item in ViewBag.data)
                    {
                        <td>@item.ReRa%</td>
                    }
                </tr>
                <tr>
                    <th><p>@Html.ActionLink("Safety Issues (H&S)", "Index", "Safety_HS")</p></th>
                    <th scope="row">Joel Quintana</th>
                    <th scope="row">0 Incidents</th>
                    @foreach (var item in ViewBag.data)
                    {
                        <td>@item.Safe</td>
                    }
                </tr>
                <tr>
                    <th><p>@Html.ActionLink("Scrap Cost", "Index", "Scrap")</p></th>
                    <th scope="row">Erasmo Arellano</th>
                    <th scope="row">(USD) Mensual</th>
                    @foreach (var item in ViewBag.data)
                    {
                        <td>@string.Format("{0:0,0,0}", @item.ScCo)</td>
                    }
                </tr>
                <tr>
                    <th><p>@Html.ActionLink("TOC/H&S Audits", "Index", "TOC_HS_Audits")</p></th>
                    <th scope="row">Juan Arvizu</th>
                    <th scope="row">100%</th>
                    @foreach (var item in ViewBag.data)
                    {
                        <td>@item.Toc%</td>
                    }
                </tr>
                <tr>
                    <th><p>@Html.ActionLink("Yellow Sheet & BOM's Audited", "Index", "Yellow_Sheets")</p></th>
                    <th scope="row">Jessica Franco</th>
                    <th scope="row">100% audits</th>
                    @foreach (var item in ViewBag.data)
                    {
                        <td>@item.YeSh%</td>
                    }
                </tr>
            </tbody>
        </table>
    </div>
</div>

@section Scripts {

    <script>

        function Verify(idx)
        {
            $.post("@Url.Action("Verify","Metricos")",{ id:idx} ,function(data){
                alert(data);
            });
        }
        $('[data-toggle="tooltip"]').tooltip();
        $("#Normaldrop").chosen();

        $('#metricoTable').DataTable({
            "dom": 'lBfrtip',
            "lengthMenu": [[5, 15, 50, -1], ["5", "15", "50", "Todos"]],
            "buttons": [
                {
                    extend: 'copy',
                    orientation: 'landscape',
                    pageSize: 'LEGAL',
                    exportOptions: {
                        columns: [0, 1, 2, 3, 4, 5, 6]
                    },
                },
                {
                    extend: 'csv',
                    title: 'Metricos Ingeniería Report',
                    orientation: 'landscape',
                    pageSize: 'LEGAL',
                    exportOptions: {
                        columns: [0, 1, 2, 3, 4, 5, 6]
                    },
                },
                {
                    extend: 'print',
                    title: 'Metricos Ingeniería Report',
                    orientation: 'landscape',
                    pageSize: 'LEGAL',
                    exportOptions: {
                        columns: [0, 1, 2, 3, 4, 5, 6]
                    },
                },
                {
                    extend: 'pdfHtml5',
                    title: 'Metricos Ingeniería Report',
                    orientation: 'landscape',
                    pageSize: 'LETTER',
                    exportOptions: {
                        columns: [0, 1, 2, 3, 4, 5, 6]
                    },
                },
                {
                    extend: 'excelHtml5',
                    title: 'Metricos Ingeniería Report',
                    orientation: 'landscape',
                    pageSize: 'LEGAL',
                    exportOptions: {
                        columns: [0, 1, 2, 3, 4, 5, 6]
                    },
                }
            ],
            "order": [[0, "desc"]],
            "scrollX": true,
            "language": {
                "sProcessing": "Procesando...",
                "sLengthMenu": "Mostrar _MENU_ registros",
                "sZeroRecords": "No se encontraron resultados",
                "sEmptyTable": "Ningun dato disponible en esta tabla =(",
                "sInfo": "Mostrando registros del _START_ al _END_ de un total de _TOTAL_ registros",
                "sInfoEmpty": "Mostrando registros del 0 al 0 de un total de 0 registros",
                "sInfoFiltered": "(filtrado de un total de _MAX_ registros)",
                "sInfoPostFix": "",
                "sSearch": "Buscar:",
                "sUrl": "",
                "sInfoThousands": ",",
                "sLoadingRecords": "Cargando...",
                "oPaginate": {
                    "sFirst": "Primero",
                    "sLast": "ultimo",
                    "sNext": "Siguiente",
                    "sPrevious": "Anterior"
                },
                "oAria": {
                    "sSortAscending": ": Activar para ordenar la columna de manera ascendente",
                    "sSortDescending": ": Activar para ordenar la columna de manera descendente"
                },
                "buttons": {
                    "copy": "Copiar",
                    "colvis": "Visibilidad"
                }
            }
        });

        // Listen for when the form submits.
        $(document).ready(function () {
            if (typeof window.stackBottomLeft === 'undefined') {
                window.stackBottomLeft = {
                    'dir1': 'up',
                    'dir2': 'left',
                    'firstpos1': 25,
                    'firstpos2': 25
                };
            }
            document.getElementById('years').value = @ViewBag.indYear;
        });

        $("#years").change(function () {
            setCookie("indYear", document.getElementById('years').value, 30);
            history.go();
        });

        function setCookie(cname, cvalue, exdays) {
            const d = new Date();
            d.setTime(d.getTime() + (exdays * 24 * 60 * 60 * 1000));
            let expires = "expires=" + d.toUTCString();
            document.cookie = cname + "=" + cvalue + ";" + expires + ";path=/";
            console.log("Cookie was set to: " + cvalue)
        };
        function getCookie(cname) {
            let name = cname + "=";
            let ca = document.cookie.split(';');
            for (let i = 0; i < ca.length; i++) {
                let c = ca[i];
                while (c.charAt(0) == ' ') {
                    c = c.substring(1);
                }
                if (c.indexOf(name) == 0) {
                    return c.substring(name.length, c.length);
                }
            }
            return "";
            console.log("Cookie was retreived");
        };

        var table1 = document.getElementById('metric');
        var tbody1 = table1.getElementsByTagName('tbody')[0];
        var cells1 = tbody1.getElementsByTagName('tr');
        const dt = new Date();
        let month1 = dt.getMonth();

        for (var i = 0, len = cells1[i].cells.length; i < len; i++) {
            if ((i + 1) < len) {
                if (parseInt(cells1[0].cells[1 + i].innerHTML, 10) < 20) {
                    cells1[0].cells[1 + i].style.backgroundColor = '#ff5c5c8c';
                    cells1[0].cells[1 + i].style.color = 'black';
                }
                if (parseInt(cells1[0].cells[1 + i].innerHTML, 10) >= 20) {
                    cells1[0].cells[1 + i].style.backgroundColor = '#ffff005c';
                    cells1[0].cells[1 + i].style.color = 'black';
                }
                if (parseInt(cells1[0].cells[1 + i].innerHTML, 10) >= 80) {
                    cells1[0].cells[1 + i].style.backgroundColor = '#71d98c8c';
                    cells1[0].cells[1 + i].style.color = 'black';
                }
                if ((i + 1) == month1) {
                    cells1[0].cells[1 + i].style.borderRightColor = '#6b8cb0';
                    cells1[0].cells[1 + i].style.borderRightWidth = 'thick';
                }
                if (parseInt(cells1[1].cells[1 + i].innerHTML, 10) < 20) {
                    cells1[1].cells[1 + i].style.backgroundColor = '#ff5c5c8c';
                    cells1[1].cells[1 + i].style.color = 'black';
                }
                if (parseInt(cells1[1].cells[1 + i].innerHTML, 10) >= 20) {
                    cells1[1].cells[1 + i].style.backgroundColor = '#ffff005c';
                    cells1[1].cells[1 + i].style.color = 'black';
                }
                if (parseInt(cells1[1].cells[1 + i].innerHTML, 10) >= 80) {
                    cells1[1].cells[1 + i].style.backgroundColor = '#71d98c8c';
                    cells1[1].cells[1 + i].style.color = 'black';
                }
                if ((i + 1) == month1) {
                    cells1[1].cells[1 + i].style.borderRightColor = '#6b8cb0';
                    cells1[1].cells[1 + i].style.borderRightWidth = 'thick';
                }
                if (parseInt(cells1[2].cells[1 + i].innerHTML, 10) < 20) {
                    cells1[2].cells[1 + i].style.backgroundColor = '#ff5c5c8c';
                    cells1[2].cells[1 + i].style.color = 'black';
                }
                if (parseInt(cells1[2].cells[1 + i].innerHTML, 10) >= 20) {
                    cells1[2].cells[1 + i].style.backgroundColor = '#ffff005c';
                    cells1[2].cells[1 + i].style.color = 'black';
                }
                if (parseInt(cells1[2].cells[1 + i].innerHTML, 10) >= 80) {
                    cells1[2].cells[1 + i].style.backgroundColor = '#71d98c8c';
                    cells1[2].cells[1 + i].style.color = 'black';
                }
                if ((i + 1) == month1) {
                    cells1[2].cells[1 + i].style.borderRightColor = '#6b8cb0';
                    cells1[2].cells[1 + i].style.borderRightWidth = 'thick';
                }
                if (parseInt(cells1[3].cells[1 + i].innerHTML, 10) < 20) {
                    cells1[3].cells[1 + i].style.backgroundColor = '#ff5c5c8c';
                    cells1[3].cells[1 + i].style.color = 'black';
                }
                if (parseInt(cells1[3].cells[1 + i].innerHTML, 10) >= 20) {
                    cells1[3].cells[1 + i].style.backgroundColor = '#ffff005c';
                    cells1[3].cells[1 + i].style.color = 'black';
                }
                if (parseInt(cells1[3].cells[1 + i].innerHTML, 10) >= 80) {
                    cells1[3].cells[1 + i].style.backgroundColor = '#71d98c8c';
                    cells1[3].cells[1 + i].style.color = 'black';
                }
                if ((i + 1) == month1) {
                    cells1[3].cells[1 + i].style.borderRightColor = '#6b8cb0';
                    cells1[3].cells[1 + i].style.borderRightWidth = 'thick';
                }
                if (parseInt(cells1[4].cells[1 + i].innerHTML, 10) < 20) {
                    cells1[4].cells[1 + i].style.backgroundColor = '#ff5c5c8c';
                    cells1[4].cells[1 + i].style.color = 'black';
                }
                if (parseInt(cells1[4].cells[1 + i].innerHTML, 10) >= 20) {
                    cells1[4].cells[1 + i].style.backgroundColor = '#ffff005c';
                    cells1[4].cells[1 + i].style.color = 'black';
                }
                if (parseInt(cells1[4].cells[1 + i].innerHTML, 10) >= 80) {
                    cells1[4].cells[1 + i].style.backgroundColor = '#71d98c8c';
                    cells1[4].cells[1 + i].style.color = 'black';
                }
                if ((i + 1) == month1) {
                    cells1[4].cells[1 + i].style.borderRightColor = '#6b8cb0';
                    cells1[4].cells[1 + i].style.borderRightWidth = 'thick';
                }
            }
        }

        var table = document.getElementById('metricox');
        var tbody = table.getElementsByTagName('tbody')[0];
        var cells = tbody.getElementsByTagName('tr');
        const d = new Date();
        let month = d.getMonth();

        for (var i = 0, len = cells[i].cells.length; i < len; i++) {
            if ((i + 3) < len) {
                if (parseInt(cells[0].cells[3 + i].innerHTML, 10) < 70) {
                    cells[0].cells[3 + i].style.backgroundColor = '#ff5c5c8c';
                    cells[0].cells[3 + i].style.color = 'black';
                }
                if (parseInt(cells[0].cells[3 + i].innerHTML, 10) >= 70) {
                    cells[0].cells[3 + i].style.backgroundColor = '#ffff005c';
                    cells[0].cells[3 + i].style.color = 'black';
                }
                if (parseInt(cells[0].cells[3 + i].innerHTML, 10) >= 90) {
                    cells[0].cells[3 + i].style.backgroundColor = '#71d98c8c';
                    cells[0].cells[3 + i].style.color = 'black';
                }
                if ((i + 1) == month) {
                    cells[0].cells[3 + i].style.borderRightColor = '#6b8cb0';
                    cells[0].cells[3 + i].style.borderRightWidth = 'thick';
                }
                if (parseInt(cells[1].cells[3 + i].innerHTML, 10) > 0) {
                    cells[1].cells[3 + i].style.backgroundColor = '#ff5c5c8c';
                    cells[1].cells[3 + i].style.color = 'black';
                }
                if (parseInt(cells[1].cells[3 + i].innerHTML, 10) <= 0) {
                    cells[1].cells[3 + i].style.backgroundColor = '#71d98c8c';
                    cells[1].cells[3 + i].style.color = 'black';
                }
                if ((i + 1) == month) {
                    cells[1].cells[3 + i].style.borderRightColor = '#6b8cb0';
                    cells[1].cells[3 + i].style.borderRightWidth = 'thick';
                }
                if (parseInt(cells[2].cells[3 + i].innerHTML, 10) < 20) {
                    cells[2].cells[3 + i].style.backgroundColor = '#ff5c5c8c';
                    cells[2].cells[3 + i].style.color = 'black';
                }
                if (parseInt(cells[2].cells[3 + i].innerHTML, 10) >= 20) {
                    cells[2].cells[3 + i].style.backgroundColor = '#ffff005c';
                    cells[2].cells[3 + i].style.color = 'black';
                }
                if (parseInt(cells[2].cells[3 + i].innerHTML, 10) >= 80) {
                    cells[2].cells[3 + i].style.backgroundColor = '#71d98c8c';
                    cells[2].cells[3 + i].style.color = 'black';
                }
                if ((i + 1) == month) {
                    cells[2].cells[3 + i].style.borderRightColor = '#6b8cb0';
                    cells[2].cells[3 + i].style.borderRightWidth = 'thick';
                }
                if (parseInt(cells[3].cells[3 + i].innerHTML, 10) < 60) {
                    cells[3].cells[3 + i].style.backgroundColor = '#ff5c5c8c';
                    cells[3].cells[3 + i].style.color = 'black';
                }
                if (parseInt(cells[3].cells[3 + i].innerHTML, 10) >= 60) {
                    cells[3].cells[3 + i].style.backgroundColor = '#ffff005c';
                    cells[3].cells[3 + i].style.color = 'black';
                }
                if (parseInt(cells[3].cells[3 + i].innerHTML, 10) >= 80) {
                    cells[3].cells[3 + i].style.backgroundColor = '#71d98c8c';
                    cells[3].cells[3 + i].style.color = 'black';
                }
                if ((i + 1) == month) {
                    cells[3].cells[3 + i].style.borderRightColor = '#6b8cb0';
                    cells[3].cells[3 + i].style.borderRightWidth = 'thick';
                }
                if (parseInt(cells[4].cells[3 + i].innerHTML, 10) >= 5) {
                    cells[4].cells[3 + i].style.backgroundColor = '#ff5c5c8c';
                    cells[4].cells[3 + i].style.color = 'black';
                }
                if (parseInt(cells[4].cells[3 + i].innerHTML, 10) < 5  ) {
                    cells[4].cells[3 + i].style.backgroundColor = '#ffff005c';
                    cells[4].cells[3 + i].style.color = 'black';
                }
                if (parseInt(cells[4].cells[3 + i].innerHTML, 10) < 1) {
                    cells[4].cells[3 + i].style.backgroundColor = '#71d98c8c';
                    cells[4].cells[3 + i].style.color = 'black';
                }
                if ((i + 1) == month) {
                    cells[4].cells[3 + i].style.borderRightColor = '#6b8cb0';
                    cells[4].cells[3 + i].style.borderRightWidth = 'thick';
                }
                if (parseInt(cells[5].cells[3 + i].innerHTML, 10) < 60) {
                    cells[5].cells[3 + i].style.backgroundColor = '#ff5c5c8c';
                    cells[5].cells[3 + i].style.color = 'black';
                }
                if (parseInt(cells[5].cells[3 + i].innerHTML, 10) >= 60) {
                    cells[5].cells[3 + i].style.backgroundColor = '#ffff005c';
                    cells[5].cells[3 + i].style.color = 'black';
                }
                if (parseInt(cells[5].cells[3 + i].innerHTML, 10) >= 80) {
                    cells[5].cells[3 + i].style.backgroundColor = '#71d98c8c';
                    cells[5].cells[3 + i].style.color = 'black';
                }
                if ((i + 1) == month) {
                    cells[5].cells[3 + i].style.borderRightColor = '#6b8cb0';
                    cells[5].cells[3 + i].style.borderRightWidth = 'thick';
                }
                if (parseInt(cells[6].cells[3 + i].innerHTML, 10) < 3) {
                    cells[6].cells[3 + i].style.backgroundColor = '#ff5c5c8c';
                    cells[6].cells[3 + i].style.color = 'black';
                }
                if (parseInt(cells[6].cells[3 + i].innerHTML, 10) >= 3) {
                    cells[6].cells[3 + i].style.backgroundColor = '#ffff005c';
                    cells[6].cells[3 + i].style.color = 'black';
                }
                if (parseInt(cells[6].cells[3 + i].innerHTML, 10) >= 5) {
                    cells[6].cells[3 + i].style.backgroundColor = '#71d98c8c';
                    cells[6].cells[3 + i].style.color = 'black';
                }
                if ((i + 1) == month) {
                    cells[6].cells[3 + i].style.borderRightColor = '#6b8cb0';
                    cells[6].cells[3 + i].style.borderRightWidth = 'thick';
                }
                if (parseInt(cells[7].cells[3 + i].innerHTML, 10) < 60) {
                    cells[7].cells[3 + i].style.backgroundColor = '#ff5c5c8c';
                    cells[7].cells[3 + i].style.color = 'black';
                }
                if (parseInt(cells[7].cells[3 + i].innerHTML, 10) >= 60) {
                    cells[7].cells[3 + i].style.backgroundColor = '#ffff005c';
                    cells[7].cells[3 + i].style.color = 'black';
                }
                if (parseInt(cells[7].cells[3 + i].innerHTML, 10) >= 80) {
                    cells[7].cells[3 + i].style.backgroundColor = '#71d98c8c';
                    cells[7].cells[3 + i].style.color = 'black';
                }
                if ((i + 1) == month) {
                    cells[7].cells[3 + i].style.borderRightColor = '#6b8cb0';
                    cells[7].cells[3 + i].style.borderRightWidth = 'thick';
                }
                if (parseInt(cells[8].cells[3 + i].innerHTML, 10) < 60) {
                    cells[8].cells[3 + i].style.backgroundColor = '#ff5c5c8c';
                    cells[8].cells[3 + i].style.color = 'black';
                }
                if (parseInt(cells[8].cells[3 + i].innerHTML, 10) >= 60) {
                    cells[8].cells[3 + i].style.backgroundColor = '#ffff005c';
                    cells[8].cells[3 + i].style.color = 'black';
                }
                if (parseInt(cells[8].cells[3 + i].innerHTML, 10) >= 80) {
                    cells[8].cells[3 + i].style.backgroundColor = '#71d98c8c';
                    cells[8].cells[3 + i].style.color = 'black';
                }
                if ((i + 1) == month) {
                    cells[8].cells[3 + i].style.borderRightColor = '#6b8cb0';
                    cells[8].cells[3 + i].style.borderRightWidth = 'thick';
                }
                if (parseInt(cells[9].cells[3 + i].innerHTML, 10) < 60) {
                    cells[9].cells[3 + i].style.backgroundColor = '#ff5c5c8c';
                    cells[9].cells[3 + i].style.color = 'black';
                }
                if (parseInt(cells[9].cells[3 + i].innerHTML, 10) >= 60) {
                    cells[9].cells[3 + i].style.backgroundColor = '#ffff005c';
                    cells[9].cells[3 + i].style.color = 'black';
                }
                if (parseInt(cells[9].cells[3 + i].innerHTML, 10) >= 80) {
                    cells[9].cells[3 + i].style.backgroundColor = '#71d98c8c';
                    cells[9].cells[3 + i].style.color = 'black';
                }
                if ((i + 1) == month) {
                    cells[9].cells[3 + i].style.borderRightColor = '#6b8cb0';
                    cells[9].cells[3 + i].style.borderRightWidth = 'thick';
                }
                if (parseInt(cells[10].cells[3 + i].innerHTML, 10) < 60) {
                    cells[10].cells[3 + i].style.backgroundColor = '#ff5c5c8c';
                    cells[10].cells[3 + i].style.color = 'black';
                }
                if (parseInt(cells[10].cells[3 + i].innerHTML, 10) >= 60) {
                    cells[10].cells[3 + i].style.backgroundColor = '#ffff005c';
                    cells[10].cells[3 + i].style.color = 'black';
                }
                if (parseInt(cells[10].cells[3 + i].innerHTML, 10) >= 80) {
                    cells[10].cells[3 + i].style.backgroundColor = '#71d98c8c';
                    cells[10].cells[3 + i].style.color = 'black';
                }
                if ((i + 1) == month) {
                    cells[10].cells[3 + i].style.borderRightColor = '#6b8cb0';
                    cells[10].cells[3 + i].style.borderRightWidth = 'thick';
                }
                if (parseInt(cells[11].cells[3 + i].innerHTML, 10) < 60) {
                    cells[11].cells[3 + i].style.backgroundColor = '#ff5c5c8c';
                    cells[11].cells[3 + i].style.color = 'black';
                }
                if (parseInt(cells[11].cells[3 + i].innerHTML, 10) >= 60) {
                    cells[11].cells[3 + i].style.backgroundColor = '#ffff005c';
                    cells[11].cells[3 + i].style.color = 'black';
                }
                if (parseInt(cells[11].cells[3 + i].innerHTML, 10) >= 80) {
                    cells[11].cells[3 + i].style.backgroundColor = '#71d98c8c';
                    cells[11].cells[3 + i].style.color = 'black';
                }
                if ((i + 1) == month) {
                    cells[11].cells[3 + i].style.borderRightColor = '#6b8cb0';
                    cells[11].cells[3 + i].style.borderRightWidth = 'thick';
                }
                if (parseInt(cells[12].cells[3 + i].innerHTML, 10) < 60) {
                    cells[12].cells[3 + i].style.backgroundColor = '#ff5c5c8c';
                    cells[12].cells[3 + i].style.color = 'black';
                }
                if (parseInt(cells[12].cells[3 + i].innerHTML, 10) >= 60) {
                    cells[12].cells[3 + i].style.backgroundColor = '#ffff005c';
                    cells[12].cells[3 + i].style.color = 'black';
                }
                if (parseInt(cells[12].cells[3 + i].innerHTML, 10) >= 80) {
                    cells[12].cells[3 + i].style.backgroundColor = '#71d98c8c';
                    cells[12].cells[3 + i].style.color = 'black';
                }
                if ((i + 1) == month) {
                    cells[12].cells[3 + i].style.borderRightColor = '#6b8cb0';
                    cells[12].cells[3 + i].style.borderRightWidth = 'thick';
                }
                if (parseInt(cells[13].cells[3 + i].innerHTML, 10) > 0) {
                    cells[13].cells[3 + i].style.backgroundColor = '#ff5c5c8c';
                    cells[13].cells[3 + i].style.color = 'black';
                }
                if (parseInt(cells[13].cells[3 + i].innerHTML, 10) <= 0) {
                    cells[13].cells[3 + i].style.backgroundColor = '#71d98c8c';
                    cells[13].cells[3 + i].style.color = 'black';
                }
                if ((i + 1) == month) {
                    cells[13].cells[3 + i].style.borderRightColor = '#6b8cb0';
                    cells[13].cells[3 + i].style.borderRightWidth = 'thick';
                }
                if (parseInt(cells[14].cells[3 + i].innerHTML, 10) < 20) {
                    cells[14].cells[3 + i].style.backgroundColor = '#ff5c5c8c';
                    cells[14].cells[3 + i].style.color = 'black';
                }
                if (parseInt(cells[14].cells[3 + i].innerHTML, 10) >= 20) {
                    cells[14].cells[3 + i].style.backgroundColor = '#ffff005c';
                    cells[14].cells[3 + i].style.color = 'black';
                }
                if (parseInt(cells[14].cells[3 + i].innerHTML, 10) >= 90) {
                    cells[14].cells[3 + i].style.backgroundColor = '#71d98c8c';
                    cells[14].cells[3 + i].style.color = 'black';
                }
                if ((i + 1) == month) {
                    cells[14].cells[3 + i].style.borderRightColor = '#6b8cb0';
                    cells[14].cells[3 + i].style.borderRightWidth = 'thick';
                }
                if (parseInt(cells[15].cells[3 + i].innerHTML, 10) >= 2) {
                    cells[15].cells[3 + i].style.backgroundColor = '#ff5c5c8c';
                    cells[15].cells[3 + i].style.color = 'black';
                }
                if (parseInt(cells[15].cells[3 + i].innerHTML, 10) >= 1) {
                    cells[15].cells[3 + i].style.backgroundColor = '#ffff005c';
                    cells[15].cells[3 + i].style.color = 'black';
                }
                if (parseInt(cells[15].cells[3 + i].innerHTML, 10) <= 0) {
                    cells[15].cells[3 + i].style.backgroundColor = '#71d98c8c';
                    cells[15].cells[3 + i].style.color = 'black';
                }
                if ((i + 1) == month) {
                    cells[15].cells[3 + i].style.borderRightColor = '#6b8cb0';
                    cells[15].cells[3 + i].style.borderRightWidth = 'thick';
                }
                if (parseInt(cells[16].cells[3 + i].innerHTML, 10) > 0) {
                    cells[16].cells[3 + i].style.backgroundColor = '#ff5c5c8c';
                    cells[16].cells[3 + i].style.color = 'black';
                }
                if (parseInt(cells[16].cells[3 + i].innerHTML, 10) <= 0) {
                    cells[16].cells[3 + i].style.backgroundColor = '#71d98c8c';
                    cells[16].cells[3 + i].style.color = 'black';
                }
                if ((i + 1) == month) {
                    cells[16].cells[3 + i].style.borderRightColor = '#6b8cb0';
                    cells[16].cells[3 + i].style.borderRightWidth = 'thick';
                }
                if (parseInt(cells[17].cells[3 + i].innerHTML, 10) < 100) {
                    cells[17].cells[3 + i].style.backgroundColor = '#ff5c5c8c';
                    cells[17].cells[3 + i].style.color = 'black';
                }
                if (parseInt(cells[17].cells[3 + i].innerHTML, 10) >= 100) {
                    cells[17].cells[3 + i].style.backgroundColor = '#71d98c8c';
                    cells[17].cells[3 + i].style.color = 'black';
                }
                if ((i + 1) == month) {
                    cells[17].cells[3 + i].style.borderRightColor = '#6b8cb0';
                    cells[17].cells[3 + i].style.borderRightWidth = 'thick';
                }
                if (parseInt(cells[18].cells[3 + i].innerHTML, 10) > 0) {
                    cells[18].cells[3 + i].style.backgroundColor = '#ff5c5c8c';
                    cells[18].cells[3 + i].style.color = 'black';
                }
                if (parseInt(cells[18].cells[3 + i].innerHTML, 10) <= 0) {
                    cells[18].cells[3 + i].style.backgroundColor = '#71d98c8c';
                    cells[18].cells[3 + i].style.color = 'black';
                }
                if ((i + 1) == month) {
                    cells[18].cells[3 + i].style.borderRightColor = '#6b8cb0';
                    cells[18].cells[3 + i].style.borderRightWidth = 'thick';
                }
                if (parseInt(cells[19].cells[3 + i].innerHTML, 10) < 100) {
                    cells[19].cells[3 + i].style.backgroundColor = '#ff5c5c8c';
                    cells[19].cells[3 + i].style.color = 'black';
                }
                if (parseInt(cells[19].cells[3 + i].innerHTML, 10) >= 100) {
                    cells[19].cells[3 + i].style.backgroundColor = '#71d98c8c';
                    cells[19].cells[3 + i].style.color = 'black';
                }
                if ((i + 1) == month) {
                    cells[19].cells[3 + i].style.borderRightColor = '#6b8cb0';
                    cells[19].cells[3 + i].style.borderRightWidth = 'thick';
                }
                if (parseInt(cells[20].cells[3 + i].innerHTML, 10) < 100) {
                    cells[20].cells[3 + i].style.backgroundColor = '#ff5c5c8c';
                    cells[20].cells[3 + i].style.color = 'black';
                }
                if (parseInt(cells[20].cells[3 + i].innerHTML, 10) >= 100) {
                    cells[20].cells[3 + i].style.backgroundColor = '#71d98c8c';
                    cells[20].cells[3 + i].style.color = 'black';
                }
                if ((i + 1) == month) {
                    cells[20].cells[3 + i].style.borderRightColor = '#6b8cb0';
                    cells[20].cells[3 + i].style.borderRightWidth = 'thick';
                }
                if (parseInt(cells[21].cells[3 + i].innerHTML, 10) > 0) {
                    cells[21].cells[3 + i].style.backgroundColor = '#ff5c5c8c';
                    cells[21].cells[3 + i].style.color = 'black';
                }
                if (parseInt(cells[21].cells[3 + i].innerHTML, 10) <= 0) {
                    cells[21].cells[3 + i].style.backgroundColor = '#71d98c8c';
                    cells[21].cells[3 + i].style.color = 'black';
                }
                if ((i + 1) == month) {
                    cells[21].cells[3 + i].style.borderRightColor = '#6b8cb0';
                    cells[21].cells[3 + i].style.borderRightWidth = 'thick';
                }
                if (parseInt(cells[22].cells[3 + i].innerHTML, 10) * 1000 > 21000) {
                    cells[22].cells[3 + i].style.backgroundColor = '#ff5c5c8c';
                    cells[22].cells[3 + i].style.color = 'black';
                }
                if (parseInt(cells[22].cells[3 + i].innerHTML, 10) * 1000 <= 21000) {
                    cells[22].cells[3 + i].style.backgroundColor = '#ffff005c';
                    cells[22].cells[3 + i].style.color = 'black';
                }
                if (parseInt(cells[22].cells[3 + i].innerHTML, 10) * 1000 <= 16769) {
                    cells[22].cells[3 + i].style.backgroundColor = '#71d98c8c';
                    cells[22].cells[3 + i].style.color = 'black';
                }
                if ((i + 1) == month) {
                    cells[22].cells[3 + i].style.borderRightColor = '#6b8cb0';
                    cells[22].cells[3 + i].style.borderRightWidth = 'thick';
                }
                if (parseInt(cells[23].cells[3 + i].innerHTML, 10) < 20) {
                    cells[23].cells[3 + i].style.backgroundColor = '#ff5c5c8c';
                    cells[23].cells[3 + i].style.color = 'black';
                }
                if (parseInt(cells[23].cells[3 + i].innerHTML, 10) >= 20) {
                    cells[23].cells[3 + i].style.backgroundColor = '#ffff005c';
                    cells[23].cells[3 + i].style.color = 'black';
                }
                if (parseInt(cells[23].cells[3 + i].innerHTML, 10) >= 96) {
                    cells[23].cells[3 + i].style.backgroundColor = '#71d98c8c';
                    cells[23].cells[3 + i].style.color = 'black';
                }
                if ((i + 1) == month) {
                    cells[23].cells[3 + i].style.borderRightColor = '#6b8cb0';
                    cells[23].cells[3 + i].style.borderRightWidth = 'thick';
                }
                if (parseInt(cells[24].cells[3 + i].innerHTML, 10) < 98) {
                    cells[24].cells[3 + i].style.backgroundColor = '#ff5c5c8c';
                    cells[24].cells[3 + i].style.color = 'black';
                }
                if (parseInt(cells[24].cells[3 + i].innerHTML, 10) >= 100) {
                    cells[24].cells[3 + i].style.backgroundColor = '#71d98c8c';
                    cells[24].cells[3 + i].style.color = 'black';
                }
                if ((i + 1) == month) {
                    cells[24].cells[3 + i].style.borderRightColor = '#6b8cb0';
                    cells[24].cells[3 + i].style.borderRightWidth = 'thick';
                }
            }
        }
    </script>
}
